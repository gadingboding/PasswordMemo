## MODIFIED Requirements

### Requirement: 模板字段管理
系统 SHALL 支持用户在创建和编辑模板时管理字段定义，包括添加、删除、修改和重新排序字段。

#### Scenario: 创建模板时拖拽排序字段
- **WHEN** 用户在创建模板页面拖拽字段到新位置
- **THEN** 系统实时更新字段顺序并保持表单状态同步

#### Scenario: 编辑模板时拖拽排序字段
- **WHEN** 用户在编辑模板页面拖拽现有字段到新位置
- **THEN** 系统更新字段顺序并在保存时应用新顺序

#### Scenario: 拖拽过程中的视觉反馈
- **WHEN** 用户正在拖拽字段
- **THEN** 系统显示拖拽预览、放置指示器和半透明效果

## ADDED Requirements

### Requirement: 拖拽排序交互
系统 SHALL 提供直观的拖拽排序交互体验，支持鼠标和触摸操作。

#### Scenario: 鼠标拖拽排序
- **WHEN** 用户使用鼠标拖拽字段手柄
- **THEN** 字段跟随鼠标移动，释放时更新顺序

#### Scenario: 触摸设备拖拽排序
- **WHEN** 用户在触摸设备上拖拽字段手柄
- **THEN** 字段跟随手指移动，释放时更新顺序

#### Scenario: 拖拽手柄交互
- **WHEN** 用户悬停在字段上
- **THEN** 系统显示拖拽手柄，点击手柄可开始拖拽

### Requirement: 字段顺序一致性
系统 SHALL 确保模板字段顺序在所有相关界面中保持一致。

#### Scenario: 记录创建页面字段顺序
- **WHEN** 用户基于模板创建记录
- **THEN** 系统按模板中定义的字段顺序显示字段

#### Scenario: 记录编辑页面字段顺序
- **WHEN** 用户编辑基于模板的记录
- **THEN** 系统按模板中定义的字段顺序显示字段

#### Scenario: 记录查看页面字段顺序
- **WHEN** 用户查看记录详情
- **THEN** 系统按模板中定义的字段顺序显示字段值

#### Scenario: 模板更新后顺序同步
- **WHEN** 用户更新模板字段顺序
- **THEN** 系统在下次加载相关页面时应用新顺序

### Requirement: 拖拽状态管理
系统 SHALL 正确管理拖拽过程中的状态和表单数据。

#### Scenario: 拖拽过程中表单状态保持
- **WHEN** 用户正在拖拽字段
- **THEN** 系统保持所有字段的输入状态和验证状态

#### Scenario: 拖拽完成数据同步
- **WHEN** 用户完成拖拽操作
- **THEN** 系统更新内部字段顺序数组并重新渲染界面

#### Scenario: 拖拽操作冲突处理
- **WHEN** 用户在编辑字段内容时尝试拖拽
- **THEN** 系统优先处理编辑操作，拖拽手柄在编辑时禁用